{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap 5 CSS CDN -->
  <title>GOD·GOALS·GLORY</title>
  <link rel="shortcut icon" href="{% static 'fav-1-150x150.png' %}" type="image/x-icon">

  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/homepage.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
    rel="stylesheet">
  <!-- Optional: Add custom CSS here -->
  <style>
    /* Add your custom styles here */
    .container {
      padding-top: 20px;
    }
  </style>
</head>

<body>
  <nav class="navbar sticky-top bg-body-tertiaryi">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">GOD·GOALS·GLORY</a>
      <a class="navbar-brand" href="#">BASICS</a>
      <a class="navbar-brandi" href="#">BASICS</a>

      <ul class="nav justify-content-center">
        <li class="nav-item">

          <a class="nav-link" href="#"><i class="bi bi-house"></i></a>
        </li>
        {% if user.is_authenticated %}
        <li class="nav-item">
          <a class="nav-link"><i class="bi bi-cart"></i></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'profile' %}">
            <i class="bi bi-person-circle"></i>  Hi, {{user.first_name}}
          </a>
          {% else %}
        <li class="nav-item">
          <a class="nav-link" href="{% url 'login' %}">
            <i class="bi bi-box-arrow-in-left"></i> Login
          </a>
          {% endif %}
        </li>
      </ul>
    </div>
  </nav>
  <!-- Hero Section with Video Background -->
<div class="hero-container position-relative text-white text-center">
  <video autoplay muted loop playsinline class="hero-video">
      <source src="{% static 'assets/videos/hero-video.mp4' %}" type="video/mp4" autoplay muted loop playsinline>
      Your browser does not support the video tag.
  </video>
  <div class="hero-overlay d-flex flex-column justify-content-center align-items-center">
      <h1 class="display-3 fw-bold">GOD · GOALS · GLORY</h1>
      <p class="lead">Strive for greatness, guided by faith and purpose.</p>
      <a href="#explore" class="btn btn-primary btn-lg mt-3">Explore More</a>
  </div>
</div>

<!-- Custom CSS for Hero Section -->


  <!-- Container for your content -->
  <div class="container">
    <!-- Add your content here -->
    <h1>Hello, Bootstrap!</h1>
    <p>Start building your page inside this container.</p>
    <section class="video py-5 overflow-hidden">
      <div class="container-fluid">
        <div class="row justify-content-center">
          <div class="col-12 text-center" data-aos="zoom-out">
            <div class="video-bg position-relative">
              <img src="{% static 'assets/images/video-image.jpg' %}" alt="video" class="video-image img-fluid"
                id="vidd">
              <div class="video-player position-absolute top-50 start-50 translate-middle">
                <a href="#" data-bs-toggle="modal" data-bs-target="#videoModal" class="btn">
                  <i class="bi bi-play-circle-fill display-1"></i>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Video Modal -->
      <!-- Fullscreen Video Modal -->
      <!-- Video Modal -->
      <div class="modal fade" id="videoModal" tabindex="-1" aria-labelledby="videoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered"> <!-- Changed from fullscreen to 'modal-lg' -->
          <div class="modal-content">
            <div class="modal-header border-0">
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-0">
              <div class="ratio ratio-16x9">
                <iframe width="560" height="315" src="https://www.youtube.com/embed/ivohCQaA64s"
                  title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; 
              encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
                </iframe>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <br>
    <br>

    <div class="row row-cols-2 row-cols-md-3 g-4">
      {% for product in products %}
      <div class="col">
        <div class="card h-100">
          {% if product.status == 'sold_out' %}
          <span class="sold-out-badge">SOLD OUT</span>
          {% endif %}

          <!-- <img src="{% static 'assets/images/single-image-2.jpg' %}" class="card-img-top" alt="..."> -->
          <img src="{{ product.image.url }}" alt="{{ product.name }}" class="card-img-top" data-bs-toggle="modal"
            data-bs-target="#productModal{{ product.id }}">

          <div class="card-footer">
            <small class="text-body-secondary">
              {% if product.average_rating >= 0.5 %}
              {% with ''|center:product.average_rating as range %}
              {% for _ in range %}⭐{% endfor %}
              {% endwith %}
              {{ product.average_rating|floatformat:1 }}
              {% else %}
              No rating yet
              {% endif %}
            </small>
            <small class="text-body-secondary" id="details" data-bs-toggle="modal"
              data-bs-target="#productModal{{ product.id }}">
              View Details
              <i class="bi bi-arrow-right-circle"></i>
            </small>
            <small class="text-body-secondary" id="detailis">
              <i class="bi bi-arrow-right-circle" data-bs-toggle="modal"
                data-bs-target="#productModal{{ product.id }}"></i>
            </small>
          </div>
          <div class="card-body">
            <h6 class="card-title">{{ product.name }}</h6>
            <p class="card-text">
              TZS. {{ product.price }}
            </p>
          </div>
        </div>
      </div>

      <!-- Enhanced Modal -->
      <div class="modal fade" id="productModal{{ product.id }}" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-centered">
          <div class="modal-content border-0 shadow-lgk">
            <!-- Modal Header -->
            <div class="modal-header border-0 pb-0">
              <h5 class="modal-title fw-bold fs-4">Product {{ forloop.counter }}</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
              <div class="row g-4">
                <!-- Left Column: Carousel and Product Details -->
                <div class="col-lg-6 pe-lg-4">
                  <!-- Enhanced Carousel -->
                  <div id="productCarousel{{ product.id }}" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner rounded-3">
                      <div class="carousel-item active">
                        <img src="{{ product.image.url }}" class="d-block w-100" alt="{{ product.name }}"
                          style="max-height: 400px; object-fit: cover;">
                      </div>
                      {% if product.image_2 %}
                      <div class="carousel-item">
                        <img src="{{ product.image_2.url }}" class="d-block w-100" alt="{{ product.name }}"
                          style="max-height: 400px; object-fit: cover;">
                      </div>
                      {% endif %}
                      {% if product.image_3 %}
                      <div class="carousel-item">
                        <img src="{{ product.image_3.url }}" class="d-block w-100" alt="{{ product.name }}"
                          style="max-height: 400px; object-fit: cover;">
                      </div>
                      {% endif %}
                      {% if product.image_4 %}
                      <div class="carousel-item">
                        <img src="{{ product.image_4.url }}" class="d-block w-100" alt="{{ product.name }}"
                          style="max-height: 400px; object-fit: cover;">
                      </div>
                      {% endif %}

                      <!-- Add more images here if needed -->
                    </div>
                    {% if product.image_2 %}
                    <button class="carousel-control-prev" type="button"
                      data-bs-target="#productCarousel{{ product.id }}" data-bs-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button"
                      data-bs-target="#productCarousel{{ product.id }}" data-bs-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Next</span>
                    </button>
                    {% endif %}
                  </div>

                  <!-- Product Details -->
                  <div class="mt-4 p-4 border rounded shadow-sm bg-white">
                    <h3 class="fw-bold text-secondary">{{ product.name }}</h3>
                    <button type="submit" class="btn btn-primary" style="width: fit-content;">
                      <!-- <i class="bi bi-cash"></i>  -->
                      <i class="bi bi-cash-45deg"></i>

                      TZS {{ product.price|floatformat:2 }}
                    </button>
                    
                    <!-- <h5 class="text-success fw-semibold mt-2"></h5> -->

                    <p class="text-muted mt-3"><strong>Description:</strong> {{ product.description }}</p>

                    <div class="mt-2">
                      <small class="text-body-secondary d-flex align-items-center">
                        {% if product.average_rating >= 0.5 %}
                        {% with ''|center:product.average_rating as range %}
                        {% for _ in range %} <span class="text-warning fs-5">⭐</span> {% endfor %}
                        {% endwith %}
                        <span class="ms-2 fw-medium">{{ product.average_rating|floatformat:1 }}/5</span>
                        {% else %}
                        <span class="text-muted">No rating yet</span>
                        {% endif %}
                      </small>
                    </div>
                  </div>

                </div>

                <!-- Right Column: Reviews and Rating -->
                <div class="col-lg-6 ps-lg-4">
                  <div class="sticky-top" style="top: 1rem;">
                    {% if user.is_authenticated %}
                    <!-- Rating Section -->
                    <div class="card border-0 bg-light p-3 mb-4 shadow-sm">
                      <h6 class="fw-bold mb-3">Rate this product</h6>
                      <form method="POST" action="{% url 'add_rating' product.id %}">
                        {% csrf_token %}
                        <select name="stars" class="form-select mb-3">
                          <option value="5">5 ⭐⭐⭐⭐⭐</option>
                          <option value="4">4 ⭐⭐⭐⭐</option>
                          <option value="3">3 ⭐⭐⭐</option>
                          <option value="2">2 ⭐⭐</option>
                          <option value="1">1 ⭐</option>
                        </select>
                        <!-- <button type="submit" class="btn btn-primary w-100">Submit Rating</button> -->
                        <button type="submit" class="submit-btn">
                          <span class="btn-text">Submit Rating</span>
                      </button>
                      
                      </form>
                    </div>

                    <!-- Reviews Section -->
                    <div class="reviews-section">
                      <h6 class="fw-bold mb-3">Reviews</h6>
                      <div class="reviews-container mb-3" style="max-height: 200px; overflow-y: auto;">
                        {% for review in product.reviews.all %}
                        <div class="review-item mb-3 p-3 bg-light rounded-3">
                          <div class="d-flex align-items-center mb-2">
                            <strong class="me-2">{{ review.user.get_full_name }}</strong>
                            <small class="text-muted">{{ review.created_at|timesince }} ago</small>
                          </div>
                          <p class="mb-0">{{ review.comment }}</p>
                        </div>
                        {% empty %}
                        <p class="text-muted mb-0">Be the first to review this product!</p>
                        {% endfor %}
                      </div>

                      <!-- Add Review Form -->
                      <form method="POST" action="{% url 'add_review' product.id %}" class="mt-3">
                        {% csrf_token %}
                        <div class="input-group">
                          <textarea class="form-control" name="comment" rows="2" placeholder="Share your thoughts..."
                            required></textarea>
                          <button type="submit" class="btn btn-primary" style="width: fit-content;">
                            Comment 
                            <i class="bi bi-send-fill"></i> 
                          </button>
                          
                        </div>
                      </form>
                    </div>
                    {% else %}
                    <!-- Login Prompt -->
                    <div class="text-center py-4">
                      <p class="mb-3">Sign in to rate and review this product</p>
                      <a href="{% url 'login' %}" class="btn btn-outline-primary">Login</a>
                    </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <p class="text-muted mb-0">Be the first to review this product!</p>
      {% endfor %}

      <!-- Repeat the card structure for other cards -->
      <div class="col">
        <div class="card h-100">
          <img src="{% static 'assets/images/single-image-2.jpg' %}" class="card-img-top" alt="...">
          <div class="card-body">
            <h5 class="card-title">Card title</h5>
            <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional
              content. This content is a little bit longer.</p>
          </div>
          <div class="card-footer">
            <small class="text-body-secondary">Last updated 3 mins ago</small>
          </div>
        </div>
      </div>
      <div class="col">
        <div class="card h-100">
          <img src="{% static 'assets/images/single-image-2.jpg' %}" class="card-img-top" alt="...">
          <div class="card-body">
            <h5 class="card-title">Card title</h5>
            <p class="card-text">
              sold-out-badge
              This is a wider card with supporting text below as a natural lead-in to additional content. This content
              is a little bit longer.</p>
          </div>
          <div class="card-footer">
            <small class="text-body-secondary">Last updated 3 mins ago</small>
          </div>
        </div>
      </div>
      <div class="col">
        <div class="card h-100">
          <img src="{% static 'assets/images/single-image-2.jpg' %}" class="card-img-top" alt="...">
          <div class="card-body">
            <h5 class="card-title">Card title</h5>
            <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional
              content. This content is a little bit longer.</p>
          </div>
          <div class="card-footer">
            <small class="text-body-secondary">Last updated 3 mins ago</small>
          </div>
        </div>
      </div>
    </div>







    <footer class="footer">
      <div class="container">
        <span>
          All rights reserved.
          <br>
          &copy;
          2025 GOD·GOALS·GLORY.
        </span>
      </div>
    </footer>

            <!-- Toast Messages -->
            {% if messages %}
            <div class="fixed-toast-container">
                {% for message in messages %}
                <div class="toast-message {% if message.tags %}{{ message.tags }}{% endif %}">
                    <div class="toast-content">
                        <div class="toast-text">{{ message }}</div>
                        <button type="button" class="toast-close" onclick="this.parentElement.parentElement.remove()">×</button>
                    </div>
                    <div class="toast-progress">
                        <div class="progress-bar"></div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  </div>

  <!-- Bootstrap 5 JS and dependencies (Popper.js and Bootstrap JS) -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
</body>

</html>